<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Bodega GF Monte Verde</title>

    <!-- Librer√≠a del lector QR -->
    <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>

    <style>
        /* Fondo de pantalla */
        body{
            margin:0;
            padding:0;
            font-family: Arial, sans-serif;
            background-image:url("/static/fondo_mv.png");   /* ‚Üê tu imagen de fondo */
            background-size:cover;
            background-position:center;
            background-repeat:no-repeat;
            background-attachment:fixed;
            text-align:center;
        }

        /* Caja semitransparente para resaltar el formulario */
        .contenedor{
            background:rgba(255,255,255,0.90);
            margin: 80px auto;
            padding:30px 40px;
            border-radius:15px;
            max-width:500px;
            box-shadow:0 4px 12px rgba(0,0,0,0.3);
        }

        /* Logo */
        .logo{
            max-width:200px;
            margin-bottom:20px;
        }

        /* Lector QR */
        #qr-reader{
            width:300px;
            margin:0 auto;
        }

        /* Formulario */
        form{ margin-top:20px; }
        label, input, select, button{
            display:block;
            width:90%;
            max-width:300px;
            margin:10px auto;
            padding:11px;
            border-radius:6px;
            font-size:16px;
        }
        input, select{ border:1px solid #ccc; }
        button{
            background:#2d572c;
            color:#fff;
            border:none;
            font-weight:bold;
            cursor:pointer;
        }
        button:hover{ background:#244722; }

        .mensaje{ margin-top:20px;font-weight:bold; }
    </style>
</head>

<body>
    <div class="contenedor">
        <!-- Logo -->
        <img src="/static/MV_Logo.png" alt="Logo Monte Verde" class="logo">

        <h1>Bodega GF Monte Verde</h1>

        <!-- Lector QR -->
        <div id="qr-reader"></div>

        <!-- Formulario -->
        <form method="POST" id="movForm">
            <label for="codigo">C√≥digo (escanea o escribe manualmente):</label>
            <input type="text" id="codigo" name="codigo" required placeholder="Ej: 123456">

            <label for="tipo">Tipo de movimiento:</label>
            <select name="tipo" id="tipo">
                <option value="entrada">Entrada</option>
                <option value="salida">Salida</option>
            </select>

            <label for="cantidad">Cantidad:</label>
            <input type="number" name="cantidad" id="cantidad" required min="1" placeholder="Ej: 25">

            <button type="submit">Registrar movimiento</button>
        </form>

        {% if mensaje %}
            <div class="mensaje">{{ mensaje }}</div>
        {% endif %}
    </div>

    <!-- Script de inicio de la c√°mara -->
    <script>
        function iniciarCamara(){
            const qrScanner = new Html5Qrcode("qr-reader");
            qrScanner.start(
                { facingMode:"environment" },
                { fps:10, qrbox:250 },
                decodedText => { document.getElementById("codigo").value = decodedText; },
                error => { console.log("Error escaneando:", error); }
            ).catch(err=>{
                document.getElementById("qr-reader").innerText =
                    "üö´ C√°mara no disponible o acceso denegado.";
                console.error("Error al iniciar c√°mara:", err);
            });
        }
        window.addEventListener("load", iniciarCamara);
    </script>
</body>
</html>

